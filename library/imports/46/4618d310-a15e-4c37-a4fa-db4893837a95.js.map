{"version":3,"sources":["..\\..\\..\\..\\assets\\scripts/assets\\scripts\\player.js"],"names":["cc","Class","extends","Component","properties","jumpHeight","jumpDuration","maxMoveSpeed","v0","pixelPro","accel","setJumpAction","onLoad","accLeft","accRight","xSpeed","winSize","tmpV","initY","node","y","systemEvent","on","SystemEvent","EventType","KEY_DOWN","onKeyDown","KEY_UP","onKeyUp","onDestroy","off","event","keyCode","macro","KEY","a","d","start","update","dt","Math","min","abs","x","width","s","scaleX","scaleY"],"mappings":"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","file":"player.js","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] https://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        // foo: {\r\n        //     // ATTRIBUTES:\r\n        //     default: null,        // The default value will be used only when the component attaching\r\n        //                           // to a node for the first time\r\n        //     type: cc.SpriteFrame, // optional, default is typeof default\r\n        //     serializable: true,   // optional, default is true\r\n        // },\r\n        // bar: {\r\n        //     get () {\r\n        //         return this._bar;\r\n        //     },\r\n        //     set (value) {\r\n        //         this._bar = value;\r\n        //     }\r\n        // },\r\n        // 主角跳跃高度\r\n        jumpHeight: 0,\r\n        // 主角跳跃持续时间\r\n        jumpDuration: 0,\r\n        // 最大移动速度\r\n        maxMoveSpeed: 0,\r\n        //起跳速度\r\n        v0:10,\r\n        //像素比\r\n        pixelPro:100,\r\n        // 加速度\r\n        accel: 0\r\n    },\r\n    setJumpAction:function(){\r\n        // var jumpUp = cc.moveBy(this.jumpDuration,cc.v2(0,this.jumpHeight)).easing(cc.easeCubicActionOut());\r\n        // var jumpDowm = cc.moveBy(this.jumpDuration,cc.v2(0,-this.jumpHeight)).easing(cc.easeCubicActionIn());        \r\n        // return cc.repeatForever(cc.sequence(jumpUp,jumpDowm));\r\n    },\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad () {\r\n        //this.jumpAction=this.setJumpAction();\r\n        //this.node.runAction(this.jumpAction);\r\n\r\n         // 加速度方向开关\r\n         this.accLeft = false;\r\n         this.accRight = false;\r\n         // 主角当前水平方向速度\r\n         this.xSpeed = 0;\r\n         this.winSize=cc.winSize;\r\n         //当前速度\r\n         this.tmpV = this.v0;\r\n         //initY;\r\n         this.initY=this.node.y;\r\n         // 初始化键盘输入监听\r\n         cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\r\n         cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);   \r\n    },\r\n    onDestroy () {\r\n        // 取消键盘输入监听\r\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\r\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);\r\n    },\r\n    onKeyDown (event) {\r\n        // set a flag when key pressed\r\n        switch(event.keyCode) {\r\n            case cc.macro.KEY.a:\r\n                this.accLeft = true;\r\n                break;\r\n            case cc.macro.KEY.d:\r\n                this.accRight = true;\r\n                break;\r\n        }\r\n    },\r\n\r\n    onKeyUp (event) {\r\n        // unset a flag when key released\r\n        switch(event.keyCode) {\r\n            case cc.macro.KEY.a:\r\n                this.accLeft = false;\r\n                break;\r\n            case cc.macro.KEY.d:\r\n                this.accRight = false;\r\n                break;\r\n        }\r\n    },\r\n\r\n\r\n    start () {\r\n        \r\n    },\r\n\r\n    update (dt) {\r\n         // 根据当前加速度方向每帧更新速度\r\n         if (this.accLeft) {\r\n            \r\n            if(this.xSpeed>0){\r\n                this.xSpeed -= this.accel * dt*2;\r\n            }else{\r\n                this.xSpeed -= this.accel * dt;\r\n            }\r\n\r\n        \r\n        } else if (this.accRight) {\r\n            if(this.xSpeed<0){\r\n                this.xSpeed += this.accel * dt*2;\r\n            }else{\r\n                this.xSpeed += this.accel * dt;\r\n            }\r\n        }else{//衰减速度\r\n            if(this.xSpeed<0){\r\n                this.xSpeed += Math.min(Math.abs(this.xSpeed),this.accel * dt/2);\r\n            }else{\r\n                this.xSpeed -= Math.min(Math.abs(this.xSpeed),this.accel * dt/2);\r\n            }\r\n        }\r\n\r\n        // 限制主角的速度不能超过最大值\r\n        if ( Math.abs(this.xSpeed) > this.maxMoveSpeed ) {\r\n            // if speed reach limit, use max speed with current direction\r\n            this.xSpeed = this.maxMoveSpeed * this.xSpeed / Math.abs(this.xSpeed);\r\n        }\r\n\r\n        // 根据当前速度更新主角的位置\r\n        this.node.x += this.xSpeed * dt;\r\n        if(this.node.x > this.winSize.width/2){\r\n            this.node.x = this.winSize.width/2;\r\n            \r\n            this.xSpeed=-this.xSpeed;\r\n        }else if(this.node.x < -this.winSize.width/2)\r\n        {\r\n            this.node.x = -this.winSize.width/2;\r\n            this.xSpeed = -this.xSpeed;          \r\n        }\r\n\r\n        //加速度算当前的位置\r\n        var s = (this.tmpV*dt-1/2*(10)*dt*dt)*this.pixelPro; \r\n        this.tmpV +=-10*dt;\r\n        if(this.node.y +s < this.initY){\r\n            this.node.y = this.initY;\r\n            this.tmpV = this.v0;\r\n        }else{\r\n            this.node.y += s;\r\n        }\r\n\r\n        if(this.tmpV > 0){\r\n            this.node.scaleX =1 + this.tmpV/(3*this.v0);\r\n            this.node.scaleY =1 - this.tmpV/(3*this.v0);\r\n        }\r\n    },\r\n});\r\n"]}